<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, user-scalable=0"
    />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <link rel="stylesheet" href="example.css" />
    <script async type="text/javascript" src="https://www.peakfinder.org/script/peakfinder.min.js"></script>
  </head>

  <body>
    <div class="container">
      <header>
        <img
          id="logo"
          src="https://www.peakfinder.org/peakfinder.svg"
          alt="PeakFinder Logo"
          title="PeakFinder Logo"
          height="30"
          width="208"
        />
        <br />
        Demo Page
      </header>

      <div class="swmcontrols">
        <div id="pfslider"></div>
      </div>

      <div class="content">
        <canvas id="pfcanvas" oncontextmenu="event.preventDefault()"> </canvas>

        <div id="pfcanvasprogress">
          <div class="spinner" id="spinner">
            <div class="bounce1"></div>
            <div class="bounce2"></div>
            <div class="bounce3"></div>
          </div>
        </div>
      </div>

      <footer>
        <p>peakfinder.org</p>
      </footer>
    </div>

    <script type="text/javascript">
      function wasmcallback(cmd) {
        console.log('command: ' + cmd)
      }

      window.onload = () => {
        if (PFWasm.hasWasmSupport()) {
          let wasm = new PFWasm('pfcanvas') // attach to canvas
          wasm.registercallback(wasmcallback)
          wasm.load('en')
        } else {
          console.log('This browser does not support webassembly')
        }
      }

      //document.head.appendChild(script)

      //  var canvas = document.getElementById('canvas')

      // var Module = {
      //   arguments: ['{"style": "swm"}'],
      //   canvas: canvas,
      //   INITIAL_MEMORY: 32 * 1024 * 1024,
      //   totalDependencies: 0,
      //   onRuntimeInitialized: function () {
      //     var sp = document.getElementById('spinner')
      //     sp.style.display = 'none'
      //   },
      // }

      // var slider = document.getElementById('pfslider')

      // noUiSlider.create(slider, {
      //   start: [10000, 20000, 50000],
      //   connect: [true, true, true, true],
      //   range: {
      //     min: [0],
      //     '20%': [10000, 500],
      //     '40%': [20000, 500],
      //     '60%': [50000, 500],
      //     '80%': [100000, 1000],
      //     max: [300000],
      //   },
      //   pips: {
      //     mode: 'range',
      //     density: 3,
      //   },
      // })

      // // attach colors
      // var connect = slider.querySelectorAll('.noUi-connect')
      // for (var i = 0; i < connect.length; i++) {
      //   connect[i].classList.add('c-' + i + '-color')
      // }

      // window.addEventListener('load', function (event) {
      //   // attach event
      //   slider.noUiSlider.on('update', function () {
      //     var values = slider.noUiSlider.get() // get returns an array  ["4000.00", "8309.12", "12000.00"]
      //     Module._swm_set_colordistances(
      //       parseInt(values[0]),
      //       parseInt(values[1]),
      //       parseInt(values[2])
      //     )
      //   })
      // })
    </script>
  </body>
</html>
